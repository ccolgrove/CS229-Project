<?xml version="1.0"?><api><query><pages><page pageid="30865034" ns="0" title="Apple Disk Image"><revisions><rev xml:space="preserve">{{Primary sources|date=July 2011}}
{{infobox file format
| icon          = [[File:Mac OS X Disk Image.png|128px]]
| extension     = &lt;code&gt;.dmg&lt;/code&gt;, &lt;code&gt;.smi&lt;/code&gt;, &lt;code&gt;.img&lt;/code&gt;
| mime          = &lt;code&gt;application/x-apple-diskimage&lt;/code&gt;
| creatorcode   =
| uniform type  = &lt;code&gt;com.apple.disk-image&lt;/code&gt;, &lt;code&gt;com.apple.disk-image-smi&lt;/code&gt;
| owner         = [[Apple Inc.]]
| genre         =
| container for =
| contained by  =
| extended from =
| extended to   =
}}

'''Apple Disk Image''' is a proprietary [[disk image]] format commonly used with the [[Mac OS X]] operating system. The format allows secure password protection as well as [[file compression]] and hence serves both security and file distribution functions; it is most commonly used to distribute [[software]] over the Internet. Universal Disk Image (UDIF) is a flat [[file format]], and is the [[Native and foreign format|native image format]] for Mac OS X.

Newly created Apple Disk Images typically have a ''.dmg'' extension, although legacy Apple Disk Image files intended for [[Mac OS 9]] and earlier generally have ''.smi'' or ''.img'' file extensions.&lt;ref&gt;{{cite web|url= http://docs.info.apple.com/article.html?artnum=75098|title=Software Downloads: Formats and Common Error Messages|accessdate=2009-05-06}}&lt;/ref&gt; Apple Disk Image files are published with a [[MIME type]] of ''application/x-apple-diskimage''. When opened, an Apple Disk Image is &quot;[[Mount (computing)|mounted]]&quot; as a drive within the [[Macintosh Finder|Finder]].

Apple Disk Images can be created using utilities bundled with Mac OS X, specifically [[Disk Copy]] in [[Mac OS X v10.2]] and earlier and [[Disk Utility]] in [[Mac OS X v10.3]] and later. These utilities can also use Apple Disk Image files as images for burning CDs and DVDs. Disk Image files may also be managed via the [[Command line interface|command line]] using the &lt;tt&gt;hdiutil&lt;/tt&gt; utility. The format can also be opened by [[MagicISO]] and the [[freeware]] MagicDisc on [[Microsoft Windows]], along with several [[free software]] implementations.

== Data format ==

Files with the extension ''.dmg'' are essentially raw disk images (i.e. contain block data), optionally with one or two layers applied that provide compression and encryption. In hdiutil these layers are called CUDIFEncoding and CEncryptedEncoding.&lt;ref&gt;{{cite web|url=http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man1/hdiutil.1.html|title=hdiutil man page|accessdate=2008-11-30}}&lt;/ref&gt;

UDIF supports ADC (an old proprietary compression format by Apple), [[zlib]] and [[bzip2]] compression internally.

=== Header ===

The header can be described using the following C structure. All values are little-endian ('''Apple II''' byte ordering)
{| class=&quot;wikitable&quot;
|-
! Position(in Hex) !! Length (in bytes) !! Description
|-
| 000 || 4 || The integer constant '2IMG'. This integer should be little-endian, so on the Apple IIgs, this is equivalent to the four characters 'GMI2'; in ORCA/C 2.1, you can use the integer constant '2IMG'.
|-
| 004 || 4 || A four-character tag identifying the application that created the file.
|-
| 008 || 2 || The length of this header, in bytes. Should be 52.
|-
| 00A || 2 || The version number of the image file format. Should be 1.
|-
| 00C || 4 || The image format.
|-
| 010 || 4 || Flags
|-
| 014 || 4 || The number of 512-byte blocks in the disk image. This value should be zero unless the image format is 1 (ProDOS order).
|-
| 018 || 4 || Offset to the first byte of the first block of the disk in the image file, from the beginning of the file. The disk data must come before the comment and creator-specific chunks.
|-
| 01C || 4 || Length of the disk data in bytes. This should be the number of blocks * 512.
|-
| 020 || 4 || Offset to the first byte of the image comment. Can be zero if there's no comment. The comment must come after the data chunk, but before the creator-specific chunk. The comment, if it exists, should be raw text; no length byte or C-style null terminator byte is required (that's what the next field is for).
|-
| 024 || 4 || Length of the comment chunk. Zero if there's no comment.
|-
| 028 || 4 || Offset to the first byte of the creator-specific data chunk, or zero if there is none.
|-
| 02C || 4 || Length of the creator-specific chunk; zero if there is no creator-specific data.
|-
| 030 || 16 || Reserved space; this pads the header to 64 bytes. These values must all be zero.
|}

=== Image format field ===

The image format is indicated as one of the following values:

{| class=&quot;wikitable&quot;
|-
! Format!! Value
|-
| DOS 3.3 Order || 0
|-
| ProDOS Order || 1
|-
| Nibblized data || 2
|}

=== Flags ===

The flags field contains bit flags that specify details about the disk image. Bits not defined here must be zero.

{| class=&quot;wikitable&quot;
|-
! Bit !! Description
|-
| 31 || If this bit is set, the disk image is locked and no changes should be permitted to the disk data it contains. This is used by emulators to provide support for write-protecting disk images.
|-
| 8 || If this bit is set, the low byte of the flags field contains the DOS 3.3 volume number of the disk image. This bit should only be set for DOS 3.3 disk images. If the disk is DOS 3.3 format (the image format is 0), and this bit is 0, volume number 254 is assumed.
|-
| 7-0 || The DOS 3.3 volume number, from 0-254, if bit 8 is set. Otherwise these bits should be 0.
|}

== Support ==

=== Macintosh ===
In [[Mac OS X v10.2|Mac OS X v10.2.3]], Apple introduced Internet-Enabled Disk Images for use with the Apple utility Disk Copy, which was integrated into [[Disk Utility]] in 10.3. The Disk Copy application had the ability to display a multi-lingual software license agreement before mounting a disk image. The image will not be mounted unless the user indicates agreement with the license.&lt;ref&gt;{{cite web|url=http://developer.apple.com/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_disk_images.html |title=Guides |publisher=Apple |date= |accessdate=2010-10-27}}&lt;/ref&gt;

Currently, the only way to open a Disk Image in [[Mac OS 9]] is to use either the developer version of [[Disk Copy]] (version 6.4), or a beta version of the unreleased 6.5. However, both versions can only open uncompressed images; compressed Disk Images are unusable on Mac OS 9.{{Or|date=July 2011}}

=== Non-Macintosh ===
{{Original research|section|date=July 2011}}

Apple has not released any documentation on the format, but attempts to reverse engineer parts of the format have been successful. [[Free software]] implementations include dmg2img&lt;ref name=&quot;dmg2img&quot;&gt;{{cite web|url=http://vu1tur.eu.org/tools/ |title=dmg2img |publisher= |date= |accessdate=2010-10-27}}&lt;/ref&gt; and DMGExtractor.&lt;ref name=&quot;DMGExtractor&quot;&gt;{{cite web|url=http://www.catacombae.org/dmgx.html |title=DMGExtractor |publisher= |date= |accessdate=2011-01-03}}&lt;/ref&gt;

The encrypted layer was reverse engineered in an implementation called VileFault&lt;ref name=&quot;VileFault&quot;&gt;{{cite web|url=http://crypto.nsa.org/vilefault/ |title=VileFault |publisher= |date=2006-12-29 |accessdate=2010-10-27}}&lt;/ref&gt; (A [[spoonerism]] of [[FileVault]]), and dmg2img and DMGExtractor have since implemented support for encrypted images. DMG files can be converted into ISO files using software like PowerISO.&lt;ref&gt;{{cite web|url= http://www.davidtan.org/how-to-convert-dmg-to-iso-on-mac-osx-windows-and-linux/|title=How To Convert DMG To ISO in Windows, Linux &amp; Mac}}&lt;/ref&gt;&lt;ref&gt;{{cite web|url= http://hydtech.wordpress.com/2009/01/29/how-to-convert-dmg-files-to-iso-using-poweriso/|title=Convert DMG To ISO using PowerISO|accessdate=2009-02-15}}&lt;/ref&gt;

There are few options available to extract files or mount the proprietary Apple Disk Image format. The supported features are limited because of the proprietary nature of the format.

The well-known cross-platform and [[GNU General Public License|GPL]] licensed format conversion utilities are:{{Or|date=July 2011}}
* dmg2img
* DMGEXtractor
* [[PeaZip]]

dmg2img&lt;ref name=&quot;dmg2img&quot; /&gt; was originally written in [[Perl]]; however, the Perl version is no longer maintained, and the project was rewritten in [[C (programming language)|C]]. Currently, without additional tools, the resulting images may be mounted only under Mac OS X and under [[Linux]] (provided hfsplus support has been enabled). UDIF ADC-compressed images have been supported since version 1.5.

DMGExtractor&lt;ref name=&quot;DMGExtractor&quot; /&gt; is written in [[Java (programming language)|Java]] with [[Graphical user interface|GUI]], and it supports more advanced features of dmg including AES-128 encrypted images but not UDCO images.

In Windows, most dmg images can be opened using several other programs such as Acute Systems TransMac, HFSExplorer, [[7-Zip]], [[UltraISO]], and [[IsoBuster]]. MacDrive&lt;ref name=&quot;MacDrive&quot;&gt;{{cite web|author=MacDrive Features / Boot Camp / System Requirements / |url=http://www.mediafour.com/products/macdrive/ |title=MacDrive Home page |publisher=Mediafour |date= |accessdate=2010-10-27}}&lt;/ref&gt; can also mount simple dmg files as drives under windows, but not sparse disk or encrypted dmgs.

In Linux and possibly other Unix flavors, most .dmg files can be burned to CD/DVD using the program [[cdrecord]] or directly mounted to a mountpoint (e.g. &lt;tt&gt;mount -o loop,ro -t hfsplus imagefile.dmg /mnt/mountpoint&lt;/tt&gt;).

[[PowerISO]] is a proprietary, cross platform, Freeware CLI tool that runs on [[Linux]]; it can convert most proprietary image formats to ISO, and newer versions support .dmg.

== See also ==
* [[cloop]]
* [[DiskImageMounter]]
* [[Installer (Mac OS X)]]
* [[RUNZ]]
* [[Sparse image]]

== References ==

{{Reflist}}

== External links ==

* [http://developer.apple.com/documentation/DeveloperTools/Conceptual/SoftwareDistribution/Concepts/sd_disk_images.html Apple Developer Connection] A Quick Look at PackageMaker and Installer
* [http://www.macdevcenter.com/pub/a/mac/excerpt/osxph2_1004/?page=2&amp;x-maxdepth=0#chap16 O'Reilly Mac DevCenter] Tip 16-5. Create a Disk Image from a Directory in the Terminal
* [http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/hdiutil.1.html &lt;tt&gt;man&lt;/tt&gt; page for hdiutil]


{{Archive formats}}
{{Disk images}}

[[Category:Computer file formats]]
[[Category:Archive formats]]
[[Category:Mac OS X]]
[[Category:Disk images]]
[[Category:Compression file systems]]

[[ar:ØµÙØ±Ø© ÙØ±Øµ Ø£Ø¨Ù]]
[[cs:DMG]]
[[de:Disk-Image-Datei]]
[[it:Apple disk image]]
[[it:Universal Disk Image Format]]
[[pt:.dmg]]
[[sk:.dmg]]
[[sv:.dmg]]</rev></revisions></page></pages></query></api>
